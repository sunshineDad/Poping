{"openapi":"3.1.0","info":{"title":"AI Agents API","description":"API for interacting with Claude Code AI Agent","version":"0.1.0"},"paths":{"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/sessions/features":{"get":{"tags":["sessions"],"summary":"Get Available Features","description":"Get available MCP features.\n\nReturns\n- JSON envelope with feature map used for session configuration.\n  - success: bool\n  - data: dict feature_name -> { description: str, tools: list[str] }\n  - message: str\n  - timestamp: ISO-8601 string\n\nExample data\n{\n  \"memories\": {\"description\": \"Store and retrieve structured memories\", \"tools\": [\"write_memory\", \"search_memories\"]},\n  \"pdfs\": {\"description\": \"PDF page access and OCR\", \"tools\": [\"list_pages\", \"ocr_page\"]}\n}","operationId":"get_available_features_api_sessions_features_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/sessions":{"get":{"tags":["sessions"],"summary":"List Sessions","description":"List all sessions (from local index).\n\nOutput\n- JSON envelope with { sessions: Array } in data.\n  Each session object contains at least: session_id, created_at, last_accessed, metadata,\n  and enriched fields: title (from metadata or fallback) and preview (recent message text snippet if available).","operationId":"list_sessions_api_sessions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"post":{"tags":["sessions"],"summary":"Create a new session","description":"Create a new AI agent session. Optionally provide configuration to enable features (e.g., retrieval, pdfs) and permission policies.","operationId":"create_session_api_sessions_post","requestBody":{"content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/SessionCreateRequest"},{"type":"null"}],"title":"Request"},"example":{"config":{"features":{"events":true,"images":true,"pdfs":true,"retrieval":true},"permission_control_mode":"auto","permission_policies":{"mode":"auto","auto":{"allow":["image_*"],"prompt":["delete_*"]}},"continue_conversation":true},"metadata":{"title":"My Session"}}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"x-codeSamples":[{"lang":"bash","label":"curl","source":"curl -X POST http://localhost:8000/api/sessions -H 'Content-Type: application/json' -d '{\n  \"config\": { \"features\": {\"pdfs\": true, \"retrieval\": true } }\n}'"},{"lang":"python","label":"httpx","source":"import httpx\nhttpx.post('http://localhost:8000/api/sessions', json={'config': {'features': {'retrieval': True}}}).json()"},{"lang":"ts","label":"frontend","source":"// frontend/src/services/api.ts\n// Uses AIGentsManager.getOrCreateClient() which POSTs to /api/sessions under the hood\nconst client = await aigentsManager.getOrCreateClient(undefined, 'auto')"}],"x-frontend":{"file":"frontend/src/services/api.ts","calls":["AIGentsManager.getOrCreateClient"],"notes":"Creates a new session when no sessionId is provided."},"x-internal":{"manager":"core.manager_pool.ManagerPool.get → core.manager.AIAgentManager.initialize","config":"core.mcp_config.MCPManager.build_config","storage":"core.sessions.Sessions.create"}}},"/api/sessions/{session_id}":{"get":{"tags":["sessions"],"summary":"Get Session","description":"Get session information.\n\nPath params\n- session_id: str The session identifier.\n\nOutput\n- JSON envelope with SessionInfo for the given session.","operationId":"get_session_api_sessions__session_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["sessions"],"summary":"Delete Session","description":"Delete a session.\n\nPath params\n- session_id: str The session identifier.\n\nOutput\n- JSON envelope; message indicates deletion outcome.","operationId":"delete_session_api_sessions__session_id__delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/config":{"get":{"tags":["sessions"],"summary":"Get Session Config","description":"Get session AI configuration.\n\nReturns the user configuration saved for the session (features, custom MCP servers,\npermission mode/policies, and optional system overrides). If none, returns defaults.\n\nOutput\n- JSON envelope with user configuration dict.","operationId":"get_session_config_api_sessions__session_id__config_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["sessions"],"summary":"Update Session Config","description":"Update session AI configuration (requires manager restart).\n\nInput (body: SessionConfig)\n- features: dict[str,bool]\n- custom_mcp_servers: optional dict\n- system: optional dict\n- permission_control_mode: 'ask' | 'auto' | 'yolo'\n- permission_policies: optional dict\n\nBehavior\n- Persists user config and evicts the manager from the pool so next usage re-initializes with new settings.\n\nOutput\n- JSON envelope with { config: user_config } in data.","operationId":"update_session_config_api_sessions__session_id__config_put","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionConfig"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/title":{"put":{"tags":["sessions"],"summary":"Update Session Title","description":"Update session title in metadata.\n\nInput (body)\n- {\"title\": str}\n\nOutput\n- JSON envelope with { title, session_id }.","operationId":"update_session_title_api_sessions__session_id__title_put","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Request"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/server-info":{"get":{"tags":["sessions"],"summary":"Get SDK server info","description":"Return SDK server capabilities, styles, and resume token details (if any).","operationId":"get_server_info_api_sessions__session_id__server_info_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/query":{"post":{"tags":["query"],"summary":"Stream AI agent response","description":"Send a query to the AI agent and receive a Server-Sent Events stream. Events include: start, message (assistant/user/tool blocks), result, complete, error.","operationId":"query_ai_agent_api_sessions__session_id__query_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/QueryRequest"},"example":{"query":"Summarize my recent uploads","context":{"language":"en"}}}}},"responses":{"200":{"description":"text/event-stream (SSE)","content":{"application/json":{"schema":{}},"text/event-stream":{"examples":{"stream":{"summary":"Event stream sample","value":"data: {\"type\":\"start\",\"data\":{\"event_id\":\"20250915_101540_c0ffeec0\"}}\n\n\ndata: {\"type\":\"message\",\"data\":{\"role\":\"assistant\",\"content\":\"Let me check your resources...\"}}\n\n\ndata: {\"type\":\"result\",\"data\":{\"status\":\"success\",\"duration_ms\":4800}}\n\n\ndata: {\"type\":\"complete\",\"data\":{\"event_id\":\"20250915_101540_c0ffeec0\"}}\n\n"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"x-codeSamples":[{"lang":"bash","label":"curl (SSE)","source":"curl -N -X POST http://localhost:8000/api/sessions/{session_id}/query -H 'Content-Type: application/json' -d '{\n  \"query\": \"Hello\"\n}'"}],"x-frontend":{"file":"frontend/src/services/api.ts","calls":["api.streamChat"],"notes":"Streams messages to the UI and maps SSE to internal StreamEvent type."},"x-internal":{"manager":"core.manager.AIAgentManager.query","pipeline":["EventTracker.start_event","ClaudeSDKClient.query","receive_messages","EventTracker.add_message_to_event"]}}},"/api/sessions/{session_id}/interrupt":{"post":{"tags":["query"],"summary":"Interrupt processing","description":"Interrupt the current AI agent processing for the session.","operationId":"interrupt_processing_api_sessions__session_id__interrupt_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/resources/upload":{"post":{"tags":["resources"],"summary":"Upload a resource","description":"Upload a file to the session. Type is auto-detected from MIME/extension if not set. Supported: images, texts, docs, codes, pdf_resources. For PDFs, a background split job is queued.","operationId":"upload_resource_api_sessions__session_id__resources_upload_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_resource_api_sessions__session_id__resources_upload_post","type":"object","properties":{"file":{"type":"string","format":"binary"},"resource_type":{"type":"string"},"tags":{"type":"string"}}},"encoding":{"file":{"contentType":"*/*"}}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"x-codeSamples":[{"lang":"bash","label":"curl","source":"curl -F file=@notes.md -F tags=project,notes http://localhost:8000/api/sessions/{session_id}/resources/upload"},{"lang":"ts","label":"frontend","source":"// frontend/src/services/api.ts\nawait api.uploadFileToSession(sessionId, file, ['project','notes'])"}],"x-frontend":{"file":"frontend/src/services/api.ts","calls":["api.uploadFileToSession"],"notes":"Uploads file and returns an @resource:// tag."},"x-internal":{"flow":["ResourceManager.save","EventTracker.start/complete","ProcessingService.enqueue (PDF)","EmbeddingService.add_task (if retrieval)"]}}},"/api/sessions/{session_id}/resources":{"get":{"tags":["resources"],"summary":"List resources","description":"List resources in the session, optionally filtering by type.","operationId":"list_resources_api_sessions__session_id__resources_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"resource_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resource Type"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{},"examples":{"ok":{"value":{"success":true,"data":{"items":[{"id":"20250915_101532_deadbeef","type":"docs","name":"notes.md"}]},"message":"Found 1 resources"}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"x-frontend":{"file":"frontend/src/services/api.ts","calls":["api.getMessages"],"notes":"Resources may be shown inline in messages or via resource viewers."},"x-internal":{"flow":["ResourceManager.list"],"pagination":{"param":"limit"}}}},"/api/sessions/{session_id}/resources/{resource_id}":{"delete":{"tags":["resources"],"summary":"Delete resource","description":"Delete a resource and clean up associated embeddings if present.","operationId":"delete_resource_api_sessions__session_id__resources__resource_id__delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"resource_id","in":"path","required":true,"schema":{"type":"string","title":"Resource Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/resources/{resource_id}/content":{"get":{"tags":["resources"],"summary":"Get resource content","description":"Return resource content. Text-based resources return raw text; binary content is base64-encoded.","operationId":"get_resource_content_api_sessions__session_id__resources__resource_id__content_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"resource_id","in":"path","required":true,"schema":{"type":"string","title":"Resource Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{},"examples":{"text":{"value":{"success":true,"data":{"content":"Hello world","content_type":"text/plain"}}},"binary":{"value":{"success":true,"data":{"content":"<base64>","encoding":"base64","content_type":"image/png"}}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"x-internal":{"flow":["ResourceManager.get_metadata","ResourceManager.get_content"]}}},"/api/sessions/{session_id}/resources/{resource_id}/download":{"get":{"tags":["resources"],"summary":"Download resource","description":"Return a file download response for the resource.","operationId":"download_resource_api_sessions__session_id__resources__resource_id__download_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"resource_id","in":"path","required":true,"schema":{"type":"string","title":"Resource Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/resources/{resource_id}/content":{"get":{"tags":["resources"],"summary":"Get resource content (global)","description":"Lookup resource content across all sessions by resource ID.","operationId":"get_resource_content_global_api_resources__resource_id__content_get","parameters":[{"name":"resource_id","in":"path","required":true,"schema":{"type":"string","title":"Resource Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/events":{"get":{"tags":["history"],"summary":"List events","description":"List recent events recorded for the session (new and legacy layouts supported).","operationId":"list_events_api_sessions__session_id__events_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/events/{event_id}":{"get":{"tags":["history"],"summary":"Get event detail","description":"Return the full event metadata and message references.","operationId":"get_event_detail_api_sessions__session_id__events__event_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"event_id","in":"path","required":true,"schema":{"type":"string","title":"Event Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/messages":{"get":{"tags":["history"],"summary":"List recent messages","description":"Flatten messages from recent events for previews/history hydration.","operationId":"list_messages_api_sessions__session_id__messages_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}},{"name":"before","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Return messages before this ISO timestamp","title":"Before"},"description":"Return messages before this ISO timestamp"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/memories":{"get":{"tags":["memories"],"summary":"List memories","description":"List memories with optional filters for category/priority/status/tags.","operationId":"list_memories_api_sessions__session_id__memories_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"category","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MemoryCategory"},{"type":"null"}],"description":"Filter by category","title":"Category"},"description":"Filter by category"},{"name":"priority","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/PriorityLevel"},{"type":"null"}],"description":"Filter by priority","title":"Priority"},"description":"Filter by priority"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MemoryStatus"},{"type":"null"}],"description":"Filter by status","default":"Active","title":"Status"},"description":"Filter by status"},{"name":"tag","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by tag","title":"Tag"},"description":"Filter by tag"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Maximum number of memories to return","default":50,"title":"Limit"},"description":"Maximum number of memories to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["memories"],"summary":"Create memory","description":"Create a new structured memory document using the Memories MCP schema.","operationId":"create_memory_api_sessions__session_id__memories_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryCreateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/memories/{memory_id}":{"get":{"tags":["memories"],"summary":"Get memory detail","description":"Return a parsed memory document (Markdown to structured fields).","operationId":"get_memory_detail_api_sessions__session_id__memories__memory_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"memory_id","in":"path","required":true,"schema":{"type":"string","title":"Memory Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["memories"],"summary":"Update memory","description":"Update fields of an existing memory and increment version.","operationId":"update_memory_api_sessions__session_id__memories__memory_id__put","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"memory_id","in":"path","required":true,"schema":{"type":"string","title":"Memory Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["memories"],"summary":"Delete memory","description":"Permanently delete a memory and clean up vectors if present.","operationId":"delete_memory_api_sessions__session_id__memories__memory_id__delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"memory_id","in":"path","required":true,"schema":{"type":"string","title":"Memory Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/memories/search":{"post":{"tags":["memories"],"summary":"Search memories","description":"Search memories by content and metadata with priority/time ordering.","operationId":"search_memories_api_sessions__session_id__memories_search_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"query","in":"query","required":false,"schema":{"type":"string","default":"","title":"Query"}},{"name":"category","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MemoryCategory"},{"type":"null"}],"title":"Category"}},{"name":"priority","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/PriorityLevel"},{"type":"null"}],"title":"Priority"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MemoryStatus"},{"type":"null"}],"default":"Active","title":"Status"}},{"name":"tags","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"},"default":[],"title":"Tags"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":10,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/permissions/events":{"get":{"tags":["permissions"],"summary":"Permission events (SSE)","description":"Realtime permission requests and updates for a session via SSE.","operationId":"permission_events_api_sessions__session_id__permissions_events_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/permissions/notify":{"post":{"tags":["permissions"],"summary":"Notify a permission request","description":"Create a permission request entry and broadcast to SSE subscribers.","operationId":"notify_permission_request_api_sessions__session_id__permissions_notify_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionNotifyRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/permissions/{request_id}":{"get":{"tags":["permissions"],"summary":"Get permission request","description":"Retrieve a permission request and its status.","operationId":"get_permission_request_api_sessions__session_id__permissions__request_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"request_id","in":"path","required":true,"schema":{"type":"string","title":"Request Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/permissions":{"get":{"tags":["permissions"],"summary":"List permission requests","description":"List permission requests for a session (optionally filter by status).","operationId":"list_permissions_api_sessions__session_id__permissions_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["permissions"],"summary":"Cleanup Session Permissions","description":"清理会话的权限请求","operationId":"cleanup_session_permissions_api_sessions__session_id__permissions_delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/permissions/{request_id}/decision":{"post":{"tags":["permissions"],"summary":"Decide permission","description":"Approve or deny a permission request, optionally modifying tool input.","operationId":"permission_decision_api_sessions__session_id__permissions__request_id__decision_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"request_id","in":"path","required":true,"schema":{"type":"string","title":"Request Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermissionDecisionRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/permissions/config":{"get":{"tags":["permissions"],"summary":"Get Permissions Config","description":"Get current permission mode and policies for a session (no restart required).","operationId":"get_permissions_config_api_sessions__session_id__permissions_config_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["permissions"],"summary":"Update Permissions Config","description":"Update permission mode and/or policies for a session and apply instantly without restart.","operationId":"update_permissions_config_api_sessions__session_id__permissions_config_put","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Body"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/image-ai/styles":{"get":{"tags":["image-ai"],"summary":"List image styles","description":"Fetch available user fine-tuned styles from the AI server for image generation.","operationId":"get_image_styles_api_image_ai_styles_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/datafication/jobs":{"get":{"tags":["datafication"],"summary":"List Datafication Jobs","description":"Return lightweight summaries of existing jobs.","operationId":"list_datafication_jobs_api_datafication_jobs_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}},"post":{"tags":["datafication"],"summary":"Create Datafication Job","description":"Create a new Datafication job.","operationId":"create_datafication_job_api_datafication_jobs_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateJobRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/datafication/jobs/{job_id}":{"get":{"tags":["datafication"],"summary":"Get Datafication Job","description":"Retrieve a single Datafication job by id.","operationId":"get_datafication_job_api_datafication_jobs__job_id__get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/datafication/jobs/{job_id}/events":{"get":{"tags":["datafication"],"summary":"Stream Datafication Job Events","description":"Stream job events via SSE.","operationId":"stream_datafication_job_events_api_datafication_jobs__job_id__events_get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/pdf_resources":{"get":{"tags":["pdf_resources"],"summary":"List PDFs","description":"List PDF resources saved in the session.","operationId":"list_pdfs_api_sessions__session_id__pdf_resources_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/pdf_resources/{pdf_id}":{"get":{"tags":["pdf_resources"],"summary":"Get PDF metadata","description":"Return PDF resource metadata, including processing status and page info if available.","operationId":"get_pdf_api_sessions__session_id__pdf_resources__pdf_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"pdf_id","in":"path","required":true,"schema":{"type":"string","title":"Pdf Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/pdf_resources/{pdf_id}/pages":{"get":{"tags":["pdf_resources"],"summary":"List PDF pages","description":"List available page indices for a split PDF.","operationId":"list_pdf_pages_api_sessions__session_id__pdf_resources__pdf_id__pages_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"pdf_id","in":"path","required":true,"schema":{"type":"string","title":"Pdf Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/pdf_resources/{pdf_id}/pages/{index}/image":{"get":{"tags":["pdf_resources"],"summary":"Get page image","description":"Return base64-encoded image content for a PDF page.","operationId":"get_pdf_page_image_api_sessions__session_id__pdf_resources__pdf_id__pages__index__image_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"pdf_id","in":"path","required":true,"schema":{"type":"string","title":"Pdf Id"}},{"name":"index","in":"path","required":true,"schema":{"type":"integer","title":"Index"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/pdf_resources/{pdf_id}/pages/{index}/ocr":{"get":{"tags":["pdf_resources"],"summary":"Get page OCR","description":"Return OCR markdown content for a PDF page if available.","operationId":"get_pdf_page_ocr_api_sessions__session_id__pdf_resources__pdf_id__pages__index__ocr_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"pdf_id","in":"path","required":true,"schema":{"type":"string","title":"Pdf Id"}},{"name":"index","in":"path","required":true,"schema":{"type":"integer","title":"Index"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["pdf_resources"],"summary":"Update page OCR","description":"Update (replace) OCR markdown content for a PDF page.","operationId":"update_pdf_page_ocr_api_sessions__session_id__pdf_resources__pdf_id__pages__index__ocr_put","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"pdf_id","in":"path","required":true,"schema":{"type":"string","title":"Pdf Id"}},{"name":"index","in":"path","required":true,"schema":{"type":"integer","title":"Index"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Body"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["pdf_resources"],"summary":"Delete page OCR","description":"Delete OCR markdown content for a PDF page if it exists.","operationId":"delete_pdf_page_ocr_api_sessions__session_id__pdf_resources__pdf_id__pages__index__ocr_delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"pdf_id","in":"path","required":true,"schema":{"type":"string","title":"Pdf Id"}},{"name":"index","in":"path","required":true,"schema":{"type":"integer","title":"Index"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/canvas/state":{"get":{"tags":["canvas"],"summary":"Get Canvas State","operationId":"get_canvas_state_api_sessions__session_id__canvas_state_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/canvas/settings":{"put":{"tags":["canvas"],"summary":"Update Canvas Settings","operationId":"update_canvas_settings_api_sessions__session_id__canvas_settings_put","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Settings"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/canvas/elements":{"post":{"tags":["canvas"],"summary":"Create Element","operationId":"create_element_api_sessions__session_id__canvas_elements_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Body"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/canvas/elements/{element_id}":{"put":{"tags":["canvas"],"summary":"Update Element","operationId":"update_element_api_sessions__session_id__canvas_elements__element_id__put","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"element_id","in":"path","required":true,"schema":{"type":"string","title":"Element Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Patch"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["canvas"],"summary":"Delete Element","operationId":"delete_element_api_sessions__session_id__canvas_elements__element_id__delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"element_id","in":"path","required":true,"schema":{"type":"string","title":"Element Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/canvas/preview":{"get":{"tags":["canvas"],"summary":"Get Canvas Preview","operationId":"get_canvas_preview_api_sessions__session_id__canvas_preview_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}},{"name":"viewport_width","in":"query","required":false,"schema":{"type":"integer","maximum":4096,"minimum":16,"default":1024,"title":"Viewport Width"}},{"name":"viewport_height","in":"query","required":false,"schema":{"type":"integer","maximum":4096,"minimum":16,"default":768,"title":"Viewport Height"}},{"name":"offset_x","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset X"}},{"name":"offset_y","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset Y"}},{"name":"scale","in":"query","required":false,"schema":{"type":"number","default":1.0,"title":"Scale"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/canvas/history":{"get":{"tags":["canvas"],"summary":"List History","operationId":"list_history_api_sessions__session_id__canvas_history_get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{session_id}/canvas/history/revert":{"post":{"tags":["canvas"],"summary":"Revert History","operationId":"revert_history_api_sessions__session_id__canvas_history_revert_post","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"string","title":"Session Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Body"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_upload_resource_api_sessions__session_id__resources_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"resource_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resource Type"},"tags":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tags"}},"type":"object","required":["file"],"title":"Body_upload_resource_api_sessions__session_id__resources_upload_post"},"CreateJobRequest":{"properties":{"instruction":{"type":"string","title":"Instruction","description":"User instruction describing data transformation"},"files":{"items":{"$ref":"#/components/schemas/DataficationFilePayload"},"type":"array","title":"Files","description":"Files to process sequentially"},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata","description":"Additional job-level metadata"}},"type":"object","required":["instruction","files"],"title":"CreateJobRequest","description":"Payload for creating a new Datafication job."},"DataficationFilePayload":{"properties":{"resource_id":{"type":"string","title":"Resource Id","description":"Resource identifier returned from upload"},"resource_type":{"type":"string","title":"Resource Type","description":"Resource type (docs, texts, images, pdfs, etc.)"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name","description":"Original filename"},"size":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Size","description":"Size in bytes"},"uploaded_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Uploaded At","description":"Upload timestamp (ISO-8601)"},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata","description":"Additional metadata"},"id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Id","description":"Optional explicit file identifier"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id","description":"Existing session identifier containing this resource"}},"type":"object","required":["resource_id","resource_type"],"title":"DataficationFilePayload","description":"Incoming file representation used to build jobs."},"ErrorResponse":{"properties":{"error":{"type":"string","title":"Error"},"detail":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Detail"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code"}},"type":"object","required":["error"],"title":"ErrorResponse","description":"Error response model","example":{"code":"404","detail":"Session not found","error":"SESSION_NOT_FOUND"}},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MemoryCategory":{"type":"string","enum":["User Preferences","Project Context","Technical Specifications","Personal Information","Conversation History","Task Instructions","Domain Knowledge","Code Patterns","Custom"],"title":"MemoryCategory","description":"Standard memory categories"},"MemoryCreateRequest":{"properties":{"title":{"type":"string","maxLength":200,"minLength":1,"title":"Title","description":"Clear, descriptive title"},"category":{"$ref":"#/components/schemas/MemoryCategory","description":"Memory classification"},"context":{"type":"string","title":"Context","description":"Situational context where this information was shared"},"key_info":{"items":{"type":"string"},"type":"array","title":"Key Info","description":"Important facts and details"},"usage":{"type":"string","title":"Usage","description":"How and when to apply this information"},"priority":{"$ref":"#/components/schemas/PriorityLevel","default":"Medium"},"resources":{"items":{"type":"string"},"type":"array","title":"Resources","description":"Examples, code snippets, file paths"},"cross_refs":{"items":{"type":"string"},"type":"array","title":"Cross Refs","description":"Related memory IDs"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Additional categorization"},"author":{"type":"string","title":"Author","description":"Who created this memory","default":"AI Agent"}},"type":"object","required":["title","category","context","key_info","usage"],"title":"MemoryCreateRequest","description":"Request model for creating a memory"},"MemoryStatus":{"type":"string","enum":["Active","Archived","Deprecated"],"title":"MemoryStatus","description":"Memory status"},"MemoryUpdateRequest":{"properties":{"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"category":{"anyOf":[{"$ref":"#/components/schemas/MemoryCategory"},{"type":"null"}]},"priority":{"anyOf":[{"$ref":"#/components/schemas/PriorityLevel"},{"type":"null"}]},"context":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Context"},"key_info":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Key Info"},"resources":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Resources"},"cross_refs":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Cross Refs"},"usage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Usage"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"},"status":{"anyOf":[{"$ref":"#/components/schemas/MemoryStatus"},{"type":"null"}]}},"type":"object","title":"MemoryUpdateRequest","description":"Request model for updating a memory"},"PermissionDecisionRequest":{"properties":{"action":{"type":"string","title":"Action"},"modified_input":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Modified Input"},"deny_reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Deny Reason"}},"type":"object","required":["action"],"title":"PermissionDecisionRequest"},"PermissionNotifyRequest":{"properties":{"tool_name":{"type":"string","title":"Tool Name"},"tool_input":{"additionalProperties":true,"type":"object","title":"Tool Input"},"session_id":{"type":"string","title":"Session Id"}},"type":"object","required":["tool_name","tool_input","session_id"],"title":"PermissionNotifyRequest"},"PriorityLevel":{"type":"string","enum":["High","Medium","Low"],"title":"PriorityLevel","description":"Memory priority levels"},"QueryRequest":{"properties":{"query":{"type":"string","title":"Query","description":"The query to send to the AI agent"},"context":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Context","description":"Additional context"},"stream":{"type":"boolean","title":"Stream","description":"Whether to stream the response","default":true}},"type":"object","required":["query"],"title":"QueryRequest","description":"Query request model","example":{"context":{"language":"en"},"query":"Summarize the latest PDF I uploaded","stream":true}},"SessionConfig":{"properties":{"features":{"additionalProperties":{"type":"boolean"},"type":"object","title":"Features","description":"Built-in features to enable"},"custom_mcp_servers":{"anyOf":[{"additionalProperties":{"additionalProperties":true,"type":"object"},"type":"object"},{"type":"null"}],"title":"Custom Mcp Servers","description":"Custom MCP servers"},"system":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"System","description":"System configuration overrides"},"permission_control_mode":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Permission Control Mode","description":"Permission control mode: yolo, auto, ask"},"permission_policies":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Permission Policies","description":"Permission policies with shape: {\n  'mode': 'ask'|'auto'|'yolo',\n  'auto': { 'allow': [patterns], 'prompt': [patterns] },\n  'overrides': { tool_name: 'allow'|'prompt' }\n}"},"continue_conversation":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Continue Conversation","description":"Keep conversation state across turns"},"resume":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resume","description":"Resume token for continuing a previous session"},"max_turns":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Turns","description":"Max turns before automatic stop"},"add_dirs":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Add Dirs","description":"Allowed directories for tools"},"env":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Env","description":"Environment variables for tools"},"debug_to_stderr":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Debug To Stderr","description":"Enable CLI debug logs to stderr"}},"type":"object","title":"SessionConfig","description":"Session AI configuration"},"SessionCreateRequest":{"properties":{"config":{"anyOf":[{"$ref":"#/components/schemas/SessionConfig"},{"type":"null"}],"description":"AI configuration for the session"},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata","description":"Additional metadata"}},"type":"object","title":"SessionCreateRequest","description":"Session creation request"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"ApiKeyAuth":{"type":"apiKey","in":"header","name":"X-API-Key","description":"Optional API key header if enabled by server config."}}},"tags":[{"name":"sessions","description":"Create and manage AI agent sessions. Sessions persist resources, events, and configuration under the session directory."},{"name":"query","description":"Send user queries to the AI agent and stream structured Server-Sent Events (SSE) back, including tool-use, intermediate messages, and results."},{"name":"resources","description":"Upload, list, download, and read resources (images, texts, docs, codes, PDFs). Uploads auto-detect type by MIME/extension and persist metadata."},{"name":"history","description":"Browse events and messages recorded per session. Supports both legacy and new event storage layouts."},{"name":"memories","description":"Structured memory management (Markdown-based) including create, update, search, get, and delete. Mirrors the Memories MCP tool schema."},{"name":"permissions","description":"Realtime permission prompts over SSE and decision endpoints powering the SDK can_use_tool policy flow (ask/auto/yolo)."},{"name":"image-ai","description":"Image AI related endpoints, e.g., listing available fine-tuned styles."},{"name":"datafication","description":"Datafication workflows: manage file pools, create jobs, monitor processing, and fetch per-file results."},{"name":"pdf_resources","description":"PDF-specific operations: list PDFs, per-page images, and OCR content."},{"name":"canvas","description":"Canvas operations via MCP: state, elements, settings, preview, and versioned history."}],"servers":[{"url":"http://0.0.0.0:6006","description":"Local HTTP"},{"url":"https://0.0.0.0:6006","description":"Local HTTPS"}],"security":[{"ApiKeyAuth":[]}],"x-workflows":{"streams":[{"name":"Query Streaming","steps":["Create session","POST /api/sessions/{id}/query to start stream","Receive SSE: start → message/tool_use → result → complete","Interrupt with POST /api/sessions/{id}/interrupt if needed"]},{"name":"Resource Upload + Retrieval","steps":["Upload resource to /api/sessions/{id}/resources/upload","If retrieval is enabled, embeddings are queued","Search via Retrieval MCP tool (vector search)"]},{"name":"PDF Split + OCR","steps":["Upload PDF as resource_type=pdf_resources","Background split to per-page images","Read page image and OCR markdown via PDF routes"]},{"name":"Permission Prompting","steps":["SDK can_use_tool triggers permission request","Frontend subscribes to /permissions/events (SSE)","User approves/denies via /permissions/{request_id}/decision"]}]}}